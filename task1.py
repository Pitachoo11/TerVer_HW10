# План решения задачи
# 1. Сформулировать нулевую и альтернативную гипотезы:
#H0: средние значения роста в трех группах спортсменов равны
#H1: средние значения роста в трех группах спортсменов не равны
# 2. Выбрать уровень значимости α (0.05)
# 3. Вычислить среднее значение роста для каждой группы
# 4. Вычислить сумму квадратов отклонений наблюдений от общего среднего значения
# 5. Вычислить факторную дисперсию
# 6. Вычислить остаточную дисперсию
# 7. Вычислить значение статистики F
# 8. Найти критическое значение статистики F из таблицы распределения Фишера-Снедекора с уровнем значимости α и числом степеней свободы df1=k-1 и df2=N-k
# 9. Сравнить значение статистики F со значением критической статистики. Если F > Fкр, то нулевая гипотеза отвергается, и можно сделать вывод, что средние значения роста в трех группах спортсменов различаются

import numpy as np
import scipy.stats as st

# Рост футболистов
f = [173, 175, 180, 178, 177, 185, 183, 182]

# Рост хоккеистов
h = [177, 179, 180, 188, 177, 172, 171, 184, 180]

# Рост штангистов
s = [172, 173, 169, 177, 166, 180, 178, 177, 172, 166, 170]

# Общее количество наблюдений
n = len(f) + len(h) + len(s)

# Общее среднее значение роста
mean_height = np.mean([*f, *h, *s])

# Сумма квадратов отклонений наблюдений от общего среднего
s2 = np.sum([(i - mean_height)**2 for i in [*f, *h, *s]])

# Сумма квадратов отклонений средних групповых значений от общего среднего
k = 3
s2_fact = (np.mean(f) - mean_height)**2 * len(f) + (np.mean(h) - mean_height)**2 * len(h) + (np.mean(s) - mean_height)**2 * len(s)

# Остаточная сумма квадратов отклонений
s2_res = np.sum([(i - np.mean(g))**2 for g in [f, h, s] for i in g])

# Общая дисперсия
sigma2_general = s2 / (n - 1)

# Факторная дисперсия
sigma2_fact = s2_fact / (k - 1)

# Остаточная дисперсия
sigma2_res = s2_res / (n - k)

# F-статистика
F = sigma2_fact / sigma2_res

# Уровень значимости
alpha = 0.05

# Критическое значение F-статистики
F_critical = st.f.ppf(1 - alpha, k - 1, n - k)

print('F-статистика:', F)
print('Критическое значение F-статистики:', F_critical)

if F > F_critical:
    print('Отвергаем гипотезу H0: Средние значения роста в группах различаются.')
else:
    print('Не отвергаем гипотезу H0: Средние значения роста в группах не различаются.')